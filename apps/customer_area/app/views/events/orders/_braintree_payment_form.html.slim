.container-method [id="method-braintree"]
  .wrapper-module
    p.hint-text
      = t('orders.card_info')
    .wrapper-payments-methods
      = fa_icon "cc-visa"
      = fa_icon "cc-mastercard"
      = fa_icon "cc-amex"
    = form_tag event_order_payment_service_synchronous_payments_path(order_presenter.event, order_presenter.order, order_presenter.payment_service), method: :post, id: "braintree-payment-form", class: "basic-grey"
      .payment-errors#braintree-errors
      .control-group
        .controls
          = label_tag :card_number, t('orders.stripe.card_number'), required: true, class: "expiration-label"
          #card-number
        .controls
          = label_tag :card_verification, t('orders.stripe.card_code_verification'), required: true, class: "expiration-label"
          #card-verification
        .controls
          .expiration-month
            = label_tag :expiration_month, t('orders.stripe.card_expiration_month'), required: true, class: "expiration-label"
            #expiration-month
          .expiration-year
            = label_tag :expiration_year, t('orders.stripe.card_expiration_year'), required: true, class: "expiration-label"
            #expiration-year
        .actions
          = submit_tag t('orders.button'), class: "btn btn-action btn-action-primary"

javascript:
  if( $("#braintree-payment-form").length > 0 ) {
    var hostedFieldsStyle = {
      // Style all elements
      'input': {
        'height': '3.35rem'
      },
      'label': {
        'left': '0'
      },
      // Styling element state
      ':focus': {
        'color': '#2c2c2c2'
      },
      '.valid': {
        'color': 'green'
      },
      '.invalid': {
        'color': 'red'
      },
      // Media queries
      // Note that these apply to the iframe, not the root window.
      '@media screen and (max-width: 700px)': {
        'input': {
          'font-size': '14px'
        }
      }
    };
    var clientToken = '#{order_presenter.form_data.client_token}';
    braintree.setup(clientToken, "custom", {
      id: "braintree-payment-form",
      hostedFields: {
        styles: hostedFieldsStyle,
        number: {
          selector: "#card-number",
          placeholder: "4111 1111 1111 1111"
        },
        cvv: {
          selector: "#card-verification",
          placeholder: "123"
        },
        expirationMonth: {
          selector: "#expiration-month",
          placeholder: "MM"
        },
        expirationYear: {
          selector: "#expiration-year",
          placeholder: "YYYY"
        }
      },
      onError: function (err) {
        $("#braintree-errors").text(err.message);
      }
    });
  }