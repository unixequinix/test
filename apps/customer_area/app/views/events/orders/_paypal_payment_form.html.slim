.wrapper-module
  = form_tag event_order_payment_service_synchronous_payments_path(order_presenter.event, order_presenter.order, order_presenter.payment_service), method: :post, id: "paypal-payment-form", class: "basic-grey"
    = render "events/orders/paypal_#{order_presenter.actual_agreement_state}", order_presenter: order_presenter

javascript:
  if( $("#paypal-payment-form").length > 0 ) {
    var clientToken = '#{order_presenter.form_data.client_token}';
    braintree.setup(clientToken, "paypal", {
      container: "paypal-container",
      paypal: {
        displayName: "#{order_presenter.event.company_name}",
        singleUse: false,
        billingAgreementDescription: "#{t('registration.autotoup_agreement.billing_agreement_description')}"
      },
      dataCollector: {
        paypal: true
      },
      onPaymentMethodReceived: function (obj) {
        $("#paypal-activated-container").toggleClass("display-paypal");
      },
      onCancelled: function (obj) {
        $("#paypal-activated-container").removeClass("display-paypal");
      }
    });
  }